<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>ChangePassword</title>
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/stylesPage.css">
    <link rel="stylesheet" href="assets/css/formStylesPage.css">
</head>


<body>
    <div class="titlePage">
        <div>
            <span class="fontTitle">
                Rete Distribuzione Sacche Di Sangue             
            </span>
        </div>
    </div>
    
    
    <div class="containerForm">
        <form id="myForm">
            <div class="containerFormPass">
                <label>Codice Fiscale</label>
                <div class="form-group pass_show"> 
                    <input type="text" class="form-control" placeholder="Codice Fiscale" id="cdf">
                </div>
                   <label>Username</label>
                <div class="form-group pass_show"> 
                    <input id="user" type="text" class="form-control" placeholder="Username">
                </div>
            </div>
        </form>
        <div class="row" style="margin: 0px 33%;">
            <button class="btn" onclick="window.location.href='Login.html';"><img class="return" src="assets/img/returnBlue.png" /></button>
            <button type="submit" onclick="cambioPassword();" class="btn btn-primary" style="margin: auto;">Cambia</button>
        </div>
    </div>
    
    
    <script>

         cambioPassword = function(){
            var xhttp = new XMLHttpRequest();
            var host = document.location.origin;
            var url =host + "/rest/autentificazione/recuperoPassword/"+cdf.value;
            xhttp.onreadystatechange = function() {
                        if (this.readyState == 4 && this.status == 200 ) {
                            alert(this.response);
                            window.location.href='Login.html';
                        }else{
                            if (this.readyState == 4 && this.status != 200){
                                alert(this.response);
                                setTimeout(reloadPage,1000);
                            }
                        }
            };
    
    
            xhttp.onerror = function(){
                       alert("impossibile inviare la richiesta");
            };
    
    
            xhttp.open("PUT", url, true);
            xhttp.send(user.value);
    
        };

        function reloadPage() {
            user.value="";
            cdf.value="";
            location.reload();
        }
    </script>
    
    <div class="footer"></div>
    <script src="assets/js/websocketSaveNotification.js"></script>
    
</body>

</html>